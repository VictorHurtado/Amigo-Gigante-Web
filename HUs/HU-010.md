# HU-010 — Refactorización a Atomic Design y componentes reutilizables

**Como** equipo de desarrollo  
**Quiero** analizar y refactorizar los componentes existentes siguiendo Atomic Design  
**Para** evitar duplicación de código, mejorar reutilización y mantener consistencia en la UI

---

## Dependencias

- HU-005 (MUI configurado)
- HU-007 (Tailwind configurado)
- HU-008 (Design System centralizado)
- HU-009 (Logo en navbar - si aplica)

---

## Contexto / Notas

- Actualmente los componentes están en `src/presentation/components/home/` sin estructura de Atomic Design.
- La arquitectura (`docs/01_arquitectura.md`) define que deberían existir `atoms/`, `molecules/`, `organisms/`, `layouts/` pero no están implementados.
- Se observa código duplicado en estilos (botones, cards, chips, etc.).
- Componentes como `AnimalCard`, `HomeNavBar` tienen estilos inline que podrían extraerse a componentes más pequeños y reutilizables.
- Es necesario analizar el código existente para identificar patrones comunes y oportunidades de reutilización.

---

## Diseño

Referencias:
- Arquitectura: `docs/01_arquitectura.md` (estructura de componentes)
- Design System: `docs/design/system.md`
- Atomic Design: https://atomicdesign.bradfrost.com/

Estructura esperada:
```
src/presentation/components/
├── atoms/              # Componentes básicos (Button, Chip, Icon, etc.)
├── molecules/          # Combinaciones simples (SearchBar, NavLink, etc.)
├── organisms/          # Componentes complejos (NavBar, AnimalCard, etc.)
├── layouts/           # Layouts reutilizables (PageLayout, Section, etc.)
└── home/              # Componentes específicos de home (temporal, migrar a organisms)
```

---

## Alcance

Incluye:
- Análisis del código existente para identificar componentes reutilizables
- Creación de estructura de carpetas según Atomic Design (`atoms/`, `molecules/`, `organisms/`, `layouts/`)
- Extracción de componentes atómicos (botones, chips, iconos, etc.)
- Refactorización de componentes existentes para usar los nuevos componentes atómicos
- Documentación de la estructura y convenciones de Atomic Design
- Migración gradual de componentes de `home/` a la nueva estructura

No incluye:
- Rediseño visual de componentes
- Cambios en la funcionalidad existente
- Creación de nuevos features
- Cambios en Domain o Infrastructure

---

## Criterios de aceptación (Given / When / Then)

### 1) Estructura de Atomic Design creada

- **Dado** que se analiza el código existente
- **Cuando** se crea la estructura de carpetas
- **Entonces** existen las carpetas:
  - `src/presentation/components/atoms/`
  - `src/presentation/components/molecules/`
  - `src/presentation/components/organisms/`
  - `src/presentation/components/layouts/`
- **Y** cada carpeta tiene un `README.md` explicando su propósito

---

### 2) Componentes atómicos extraídos

- **Dado** que se analizan los componentes existentes
- **Cuando** se identifican elementos reutilizables
- **Entonces** se crean componentes atómicos como:
  - `Button` (variantes: primary, secondary, etc.)
  - `Chip` (con variantes de color según status)
  - `IconButton` (reutilizable)
  - `Logo` (componente del logo)
  - Otros elementos básicos identificados
- **Y** estos componentes usan tokens del Design System
- **Y** están documentados con ejemplos de uso

---

### 3) Componentes moleculares creados

- **Dado** que existen componentes atómicos
- **Cuando** se combinan para crear elementos más complejos
- **Entonces** se crean componentes moleculares como:
  - `NavLink` (link de navegación con hover)
  - `SearchButton` (IconButton con icono de búsqueda)
  - `StatusChip` (Chip con lógica de colores según status)
  - Otros identificados en el análisis
- **Y** estos componentes están compuestos por atoms

---

### 4) Organismos refactorizados

- **Dado** que existen atoms y molecules
- **Cuando** se refactorizan los componentes existentes
- **Entonces** componentes como `HomeNavBar`, `AnimalCard` usan los nuevos atoms y molecules
- **Y** se elimina código duplicado
- **Y** los componentes mantienen su funcionalidad original
- **Y** se migran a `organisms/` cuando corresponda

---

### 5) Layouts reutilizables

- **Dado** que existen patrones de layout comunes
- **Cuando** se analiza el código
- **Entonces** se crean layouts reutilizables como:
  - `Section` (contenedor de sección con Container y spacing)
  - `PageLayout` (si aplica)
  - Otros identificados
- **Y** estos layouts usan tokens del Design System para spacing

---

### 6) Documentación creada

- **Dado** que se implementa Atomic Design
- **Cuando** se completa la refactorización
- **Entonces** existe documentación en:
  - `src/presentation/components/README.md` (guía de Atomic Design)
  - READMEs en cada carpeta (atoms, molecules, organisms, layouts)
- **Y** se documentan las convenciones:
  - Cuándo crear un atom vs molecule vs organism
  - Cómo nombrar componentes
  - Cómo usar los componentes existentes

---

### 7) Código sin duplicación

- **Dado** que se completa la refactorización
- **Cuando** se revisa el código
- **Entonces** no hay estilos duplicados (botones, chips, etc.)
- **Y** los componentes reutilizables están en su lugar correcto según Atomic Design
- **Y** los componentes específicos de home están claramente identificados

---

## Reglas técnicas

### Arquitectura
- Presentation solo consume UseCases vía IoC (no importa repositorios concretos).
- Domain no importa React/Next/MUI/Tailwind/Inversify.
- Infrastructure contiene implementaciones y wiring IoC.

### Atomic Design
- **Atoms**: Componentes básicos que no pueden dividirse más (Button, Chip, Icon, etc.).
- **Molecules**: Combinaciones simples de atoms (SearchBar, NavLink, etc.).
- **Organisms**: Componentes complejos que combinan molecules y atoms (NavBar, AnimalCard, etc.).
- **Layouts**: Estructuras de página/sección reutilizables.

### UI
- Usar tokens del Design System (`brand-500`, `accent-500`, etc.).
- MUI se usa para componentes base, pero se envuelven en atoms propios cuando se necesita reutilización.
- Tailwind se usa para layout/spacing/responsive utilities.
- No crear componentes que solo envuelvan MUI sin agregar valor.

### Dependencias / Paquetes
- No agregar dependencias nuevas salvo que esta HU lo indique explícitamente.
- Si aparece error 403/conectividad:
  1) Detenerse
  2) Pedir dominios requeridos
  3) Explicar por qué se requieren
  4) No continuar

---

## Implementación sugerida

### Fase 1: Análisis
1. Revisar todos los componentes en `src/presentation/components/home/`
2. Identificar:
   - Estilos duplicados
   - Componentes que se repiten
   - Patrones comunes
3. Crear un documento de análisis (opcional, puede ser en comentarios)

### Fase 2: Crear estructura
1. Crear carpetas: `atoms/`, `molecules/`, `organisms/`, `layouts/`
2. Crear READMEs explicativos en cada carpeta

### Fase 3: Extraer atoms
1. Crear `atoms/Button/Button.tsx` (con variantes)
2. Crear `atoms/Chip/Chip.tsx` (con variantes)
3. Crear `atoms/IconButton/IconButton.tsx`
4. Crear `atoms/Logo/Logo.tsx`
5. Otros identificados en el análisis

### Fase 4: Crear molecules
1. Crear `molecules/NavLink/NavLink.tsx`
2. Crear `molecules/SearchButton/SearchButton.tsx`
3. Crear `molecules/StatusChip/StatusChip.tsx`
4. Otros identificados

### Fase 5: Refactorizar organisms
1. Refactorizar `HomeNavBar` para usar atoms y molecules
2. Refactorizar `AnimalCard` para usar atoms y molecules
3. Migrar a `organisms/` cuando corresponda
4. Mantener compatibilidad con código existente

### Fase 6: Crear layouts
1. Crear `layouts/Section/Section.tsx`
2. Otros identificados

### Fase 7: Documentación
1. Actualizar `src/presentation/components/README.md`
2. Documentar convenciones y ejemplos

Archivos/carpetas sugeridas:
```
src/presentation/components/
├── atoms/
│   ├── Button/
│   │   ├── Button.tsx
│   │   └── index.ts
│   ├── Chip/
│   ├── IconButton/
│   ├── Logo/
│   └── README.md
├── molecules/
│   ├── NavLink/
│   ├── SearchButton/
│   ├── StatusChip/
│   └── README.md
├── organisms/
│   ├── NavBar/
│   ├── AnimalCard/
│   └── README.md
├── layouts/
│   ├── Section/
│   └── README.md
├── home/ (temporal, migrar gradualmente)
└── README.md
```

---

## Validación

Comandos mínimos:
- `npm run dev` (verificar que todo funciona igual)
- `npm run build` (verificar que no hay errores de compilación)

Verificaciones:
- Los componentes mantienen su funcionalidad original
- No hay regresiones visuales
- El código está mejor organizado
- Se eliminó duplicación de código
- Los componentes son reutilizables

---

## Definición de Hecho

- [ ] Criterios de aceptación cumplidos
- [ ] `npm run dev` OK
- [ ] `npm run build` OK
- [ ] Estructura de Atomic Design creada
- [ ] Componentes atómicos extraídos y documentados
- [ ] Componentes existentes refactorizados
- [ ] Código sin duplicación
- [ ] Documentación completa
- [ ] Sin violaciones de capas
- [ ] Sin cambios fuera del alcance
- Commit sugerido:
  `refactor: implement atomic design and reusable components`

